import { ImageResponse } from "next/og";

export const runtime = 'edge';

export const alt = 'synsk.me';
export const size = {
  width: 1200,
  height: 630,
};

export const contentType = 'image/png';

const url =
  'https://api.open-meteo.com/v1/forecast?latitude=35.6895&longitude=139.6917&current=weathercode&timezone=Asia%2FTokyo&forecast_days=1';

export default async function Image() {
  const json = await fetch(url).then((res) => res.json());

  const isFine = Number(json.current.weathercode) === 0;

  return new ImageResponse(
    (
      <div
        style={{
          fontSize: 48,
          background: 'white',
          width: '100%',
          height: '100%',
          display: 'flex',
          alignItems: 'center',
          justifyContent: 'center',
          color: '#333',
        }}
      >
        <div
          style={{ display: 'flex', alignItems: 'center', justifyContent: 'center', width: '50%' }}
        >
          {isFine ? (
            <svg
              width="208"
              height="64"
              viewBox="0 0 515 164"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <g filter="url(#filter0_d_1097_34)">
                <path
                  d="M9.24746 113.036C9.24746 105.427 10.3017 98.5976 12.4103 92.547C14.6105 86.4048 17.7732 80.9501 21.8986 76.183H30.9745C26.6657 81.1335 23.3654 86.8173 21.0735 93.2346C18.8733 99.5602 17.7732 106.161 17.7732 113.036C17.7732 119.729 18.8733 126.283 21.0735 132.701C23.2738 139.118 26.5741 144.848 30.9745 149.89H21.8986C17.9566 145.489 14.8396 140.126 12.5478 133.801C10.3476 127.567 9.24746 120.645 9.24746 113.036ZM41.2997 113.036C41.2997 105.427 42.354 98.5976 44.4625 92.547C46.6627 86.4048 49.8255 80.9501 53.9509 76.183H63.0267C58.718 81.1335 55.4177 86.8173 53.1258 93.2346C50.9256 99.5602 49.8255 106.161 49.8255 113.036C49.8255 119.729 50.9256 126.283 53.1258 132.701C55.326 139.118 58.6263 144.848 63.0267 149.89H53.9509C50.0089 145.489 46.8919 140.126 44.6 133.801C42.3998 127.567 41.2997 120.645 41.2997 113.036ZM73.352 37.1294C73.352 29.5204 74.4062 22.6906 76.5148 16.64C78.715 10.4978 81.8778 5.04314 86.0032 0.276032H95.079C90.7703 5.22649 87.47 10.9103 85.1781 17.3276C82.9779 23.6532 81.8778 30.2538 81.8778 37.1294C81.8778 43.8217 82.9779 50.3765 85.1781 56.7937C87.3783 63.211 90.6786 68.9407 95.079 73.9828H86.0032C82.0611 69.5824 78.9442 64.2652 76.6523 58.0313C74.4521 51.7058 73.352 44.7385 73.352 37.1294ZM105.404 37.1294C105.404 29.5204 106.459 22.6906 108.567 16.64C110.767 10.4978 113.93 5.04314 118.055 0.276032H127.131C122.823 5.22649 119.522 10.9103 117.23 17.3276C115.03 23.6532 113.93 30.2538 113.93 37.1294C113.93 43.8217 115.03 50.3765 117.23 56.7937C119.431 63.211 122.731 68.9407 127.131 73.9828H118.055C114.113 69.5824 110.996 64.2652 108.705 58.0313C106.504 51.7058 105.404 44.7385 105.404 37.1294ZM337.843 80.1472C338.111 81.4901 338.38 82.833 338.38 84.1759V103.245C338.38 120.166 324.414 133.595 307.224 133.595H297.287C281.172 133.595 267.743 121.508 266.4 105.394L265.595 94.9191H256.194L255.389 105.394C254.046 121.508 240.617 133.595 224.502 133.595H214.565C197.375 133.595 183.678 120.166 183.678 103.245V84.1759C183.678 82.833 183.678 81.4901 183.947 80.1472L196.301 31.2658C197.913 24.8199 201.941 19.4483 207.85 16.2254C213.49 13.271 220.473 12.4652 226.651 14.6139L230.679 15.9568C233.097 16.7625 234.171 19.1797 233.365 21.3284L232.022 25.6256C231.216 27.7743 228.799 28.8486 226.651 28.3114L223.159 26.9685C220.205 26.1628 216.982 26.1628 214.296 27.5057C211.342 28.8486 209.462 31.5344 208.656 34.4888L198.45 75.85C204.359 73.9699 211.879 72.3584 220.205 72.3584C229.605 72.3584 240.08 74.2385 251.091 79.6101H270.698C281.709 74.2385 292.184 72.3584 301.584 72.3584C309.91 72.3584 317.43 73.9699 323.339 75.85L313.133 34.4888C312.327 31.5344 310.447 28.8486 307.493 27.5057C304.807 26.1628 301.584 26.1628 298.63 26.9685L295.138 28.3114C292.99 28.8486 290.573 27.7743 289.767 25.6256L288.424 21.3284C287.618 19.1797 288.692 16.7625 291.11 15.9568L295.138 14.6139C301.316 12.4652 308.299 13.271 313.939 16.2254C319.848 19.4483 323.876 24.8199 325.488 31.2658L337.843 80.1472ZM238.2 104.051L239.005 93.0391C232.828 90.6218 226.651 89.5475 220.205 89.5475C212.416 89.5475 205.701 91.4276 200.867 93.0391V103.245C200.867 110.497 206.776 116.405 214.565 116.405H224.502C231.485 116.405 237.662 111.034 238.2 104.051ZM321.191 103.245H320.922V93.0391C316.088 91.4276 309.373 89.5475 301.584 89.5475C295.138 89.5475 288.961 90.6218 282.784 93.0391L283.589 104.051C284.127 111.034 290.304 116.405 297.287 116.405H307.224C315.013 116.405 321.191 110.497 321.191 103.245ZM416.71 112.761C416.71 120.462 415.61 127.384 413.41 133.526C411.21 139.668 408.093 145.123 404.059 149.89H394.983C399.475 144.848 402.776 139.072 404.884 132.563C407.084 126.146 408.185 119.591 408.185 112.899C408.185 106.023 407.039 99.4226 404.747 93.0971C402.547 86.7715 399.292 81.1335 394.983 76.183H404.059C408.185 80.9501 411.301 86.4965 413.41 92.822C415.61 99.0559 416.71 105.702 416.71 112.761ZM448.763 112.761C448.763 120.462 447.662 127.384 445.462 133.526C443.262 139.668 440.145 145.123 436.111 149.89H427.036C431.528 144.848 434.828 139.072 436.936 132.563C439.137 126.146 440.237 119.591 440.237 112.899C440.237 106.023 439.091 99.4226 436.799 93.0971C434.599 86.7715 431.344 81.1335 427.036 76.183H436.111C440.237 80.9501 443.354 86.4965 445.462 92.822C447.662 99.0559 448.763 105.702 448.763 112.761ZM480.815 36.8544C480.815 44.5551 479.715 51.4766 477.515 57.6188C475.314 63.761 472.197 69.2157 468.164 73.9828H459.088C463.58 68.9407 466.88 63.211 468.989 56.7937C471.189 50.2848 472.289 43.6842 472.289 36.9919C472.289 30.1163 471.143 23.5157 468.851 17.1901C466.651 10.8645 463.397 5.22649 459.088 0.276032H468.164C472.289 5.04314 475.406 10.5895 477.515 16.9151C479.715 23.149 480.815 29.7954 480.815 36.8544ZM512.867 36.8544C512.867 44.5551 511.767 51.4766 509.567 57.6188C507.367 63.761 504.25 69.2157 500.216 73.9828H491.14C495.632 68.9407 498.932 63.211 501.041 56.7937C503.241 50.2848 504.341 43.6842 504.341 36.9919C504.341 30.1163 503.195 23.5157 500.903 17.1901C498.703 10.8645 495.449 5.22649 491.14 0.276032H500.216C504.341 5.04314 507.458 10.5895 509.567 16.9151C511.767 23.149 512.867 29.7954 512.867 36.8544Z"
                  fill="#2C2F32"
                />
              </g>
              <defs>
                <filter
                  id="filter0_d_1097_34"
                  x="-0.997228"
                  y="0.276123"
                  width="515.583"
                  height="166.301"
                  filterUnits="userSpaceOnUse"
                  color-interpolation-filters="sRGB"
                >
                  <feFlood flood-opacity="0" result="BackgroundImageFix" />
                  <feColorMatrix
                    in="SourceAlpha"
                    type="matrix"
                    values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
                    result="hardAlpha"
                  />
                  <feOffset dy="1.71891" />
                  <feGaussianBlur stdDeviation="0.859454" />
                  <feColorMatrix
                    type="matrix"
                    values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.08 0"
                  />
                  <feBlend
                    mode="normal"
                    in2="BackgroundImageFix"
                    result="effect1_dropShadow_1097_34"
                  />
                  <feBlend
                    mode="normal"
                    in="SourceGraphic"
                    in2="effect1_dropShadow_1097_34"
                    result="shape"
                  />
                </filter>
              </defs>
            </svg>
          ) : (
            <svg
              width="64"
              height="64"
              viewBox="0 0 161 160"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <g filter="url(#filter0_d_1085_61)">
                <path
                  d="M158.745 75.1472C159.013 76.4901 159.282 77.833 159.282 79.1759V98.2451C159.282 115.166 145.316 128.595 128.127 128.595H118.189C102.074 128.595 88.6454 116.508 87.3025 100.394L86.4968 89.9191H77.0965L76.2908 100.394C74.9479 116.508 61.5189 128.595 45.4041 128.595H35.4667C18.2776 128.595 4.58008 115.166 4.58008 98.2451V79.1759C4.58008 77.833 4.58008 76.4901 4.84866 75.1472L17.2033 26.2658C18.8148 19.8199 22.8435 14.4483 28.7522 11.2254C34.3924 8.27098 41.3755 7.46525 47.5528 9.61388L51.5815 10.9568C53.9987 11.7625 55.073 14.1797 54.2673 16.3284L52.9244 20.6256C52.1186 22.7743 49.7014 23.8486 47.5528 23.3114L44.0612 21.9685C41.1069 21.1628 37.8839 21.1628 35.1981 22.5057C32.2438 23.8486 30.3637 26.5344 29.558 29.4888L19.3519 70.85C25.2607 68.9699 32.7809 67.3584 41.1069 67.3584C50.5071 67.3584 60.9817 69.2385 71.9935 74.6101H91.5998C102.612 69.2385 113.086 67.3584 122.486 67.3584C130.812 67.3584 138.333 68.9699 144.241 70.85L134.035 29.4888C133.23 26.5344 131.35 23.8486 128.395 22.5057C125.709 21.1628 122.486 21.1628 119.532 21.9685L116.041 23.3114C113.892 23.8486 111.475 22.7743 110.669 20.6256L109.326 16.3284C108.52 14.1797 109.595 11.7625 112.012 10.9568L116.041 9.61388C122.218 7.46525 129.201 8.27098 134.841 11.2254C140.75 14.4483 144.779 19.8199 146.39 26.2658L158.745 75.1472ZM59.1017 99.0508L59.9074 88.0391C53.7301 85.6218 47.5528 84.5475 41.1069 84.5475C33.3181 84.5475 26.6036 86.4276 21.7692 88.0391V98.2451C21.7692 105.497 27.6779 111.405 35.4667 111.405H45.4041C52.3872 111.405 58.5645 106.034 59.1017 99.0508ZM142.093 98.2451H141.824V88.0391C136.99 86.4276 130.275 84.5475 122.486 84.5475C116.041 84.5475 109.863 85.6218 103.686 88.0391L104.492 99.0508C105.029 106.034 111.206 111.405 118.189 111.405H128.127C135.915 111.405 142.093 105.497 142.093 98.2451Z"
                  fill="#2C2F32"
                />
              </g>
              <defs>
                <filter
                  id="filter0_d_1085_61"
                  x="2.86117"
                  y="0"
                  width="159.859"
                  height="161.577"
                  filterUnits="userSpaceOnUse"
                  color-interpolation-filters="sRGB"
                >
                  <feFlood flood-opacity="0" result="BackgroundImageFix" />
                  <feColorMatrix
                    in="SourceAlpha"
                    type="matrix"
                    values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
                    result="hardAlpha"
                  />
                  <feOffset dy="1.71891" />
                  <feGaussianBlur stdDeviation="0.859454" />
                  <feColorMatrix
                    type="matrix"
                    values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.08 0"
                  />
                  <feBlend
                    mode="normal"
                    in2="BackgroundImageFix"
                    result="effect1_dropShadow_1085_61"
                  />
                  <feBlend
                    mode="normal"
                    in="SourceGraphic"
                    in2="effect1_dropShadow_1085_61"
                    result="shape"
                  />
                </filter>
              </defs>
            </svg>
          )}
        </div>
        <hr
          style={{ display: 'block', width: 1, height: '40%', background: '#333', border: 'none' }}
        />
        <div
          style={{
            display: 'flex',
            alignItems: 'center',
            justifyContent: 'center',
            width: '50%',
            letterSpacing: 2,
            fontWeight: 'bold',
          }}
        >
          synsk.me
        </div>
      </div>
    ),
    {
      ...size,
    }
  );
}
